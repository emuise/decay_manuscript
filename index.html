<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Evan Muise">
<meta name="author" content="Nicholas Coops">
<meta name="dcterms.date" content="2024-04-25">
<meta name="keywords" content="Protected areas, Matching methods, Coarsened exact matching, Essential Biodiversity Variables">

<title>Spatially explicit mapping of ecological similarity across a large region using matching techniques.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


<meta name="citation_title" content="Spatially explicit mapping of ecological similarity across a large region using matching techniques.">
<meta name="citation_abstract" content="ABSTRACT
">
<meta name="citation_keywords" content="Protected areas,Matching methods,Coarsened exact matching,Essential Biodiversity Variables">
<meta name="citation_author" content="Evan Muise">
<meta name="citation_author" content="Nicholas Coops">
<meta name="citation_publication_date" content="2024-04-25">
<meta name="citation_cover_date" content="2024-04-25">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-04-25">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Earth and Space Science">
<meta name="citation_reference" content="citation_title=Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands);,citation_author=José Marrero;,citation_author=Alicia García;,citation_author=Manuel Berrocoso;,citation_author=Ángeles Llinares;,citation_author=Antonio Rodríguez-Losada;,citation_author=R. Ortiz;,citation_publication_date=2019-07;,citation_cover_date=2019-07;,citation_year=2019;,citation_doi=10.1186/s13617-019-0085-5;,citation_volume=8;,citation_journal_title=Journal of Applied Volcanology;">
<meta name="citation_reference" content="citation_title=Priority list of biodiversity metrics to observe from space;,citation_author=Andrew K. Skidmore;,citation_author=Nicholas C. Coops;,citation_author=Elnaz Neinavaz;,citation_author=Abebe Ali;,citation_author=Michael E. Schaepman;,citation_author=Marc Paganini;,citation_author=W. Daniel Kissling;,citation_author=Petteri Vihervaara;,citation_author=Roshanak Darvishzadeh;,citation_author=Hannes Feilhauer;,citation_author=Miguel Fernandez;,citation_author=Néstor Fernández;,citation_author=Noel Gorelick;,citation_author=Ilse Geijzendorffer;,citation_author=Uta Heiden;,citation_author=Marco Heurich;,citation_author=Donald Hobern;,citation_author=Stefanie Holzwarth;,citation_author=Frank E. Muller-Karger;,citation_author=Ruben Van De Kerchove;,citation_author=Angela Lausch;,citation_author=Pedro J. Leitão;,citation_author=Marcelle C. Lock;,citation_author=Caspar A. Mücher;,citation_author=Brian O’Connor;,citation_author=Duccio Rocchini;,citation_author=Woody Turner;,citation_author=Jan Kees Vis;,citation_author=Tiejun Wang;,citation_author=Martin Wegmann;,citation_author=Vladimir Wingate;,citation_publication_date=2021-05-13;,citation_cover_date=2021-05-13;,citation_year=2021;,citation_fulltext_html_url=http://www.nature.com/articles/s41559-021-01451-x;,citation_doi=10.1038/s41559-021-01451-x;,citation_language=en;,citation_journal_title=Nature Ecology &amp;amp;amp; Evolution;">
<meta name="citation_reference" content="citation_title=Essential Biodiversity Variables;,citation_author=H. M. Pereira;,citation_author=S. Ferrier;,citation_author=M. Walters;,citation_author=G. N. Geller;,citation_author=R. H. G. Jongman;,citation_author=R. J. Scholes;,citation_author=M. W. Bruford;,citation_author=N. Brummitt;,citation_author=S. H. M. Butchart;,citation_author=A. C. Cardoso;,citation_author=N. C. Coops;,citation_author=E. Dulloo;,citation_author=D. P. Faith;,citation_author=J. Freyhof;,citation_author=R. D. Gregory;,citation_author=C. Heip;,citation_author=R. Hoft;,citation_author=G. Hurtt;,citation_author=W. Jetz;,citation_author=D. S. Karp;,citation_author=M. A. McGeoch;,citation_author=D. Obura;,citation_author=Y. Onoda;,citation_author=N. Pettorelli;,citation_author=B. Reyers;,citation_author=R. Sayre;,citation_author=J. P. W. Scharlemann;,citation_author=S. N. Stuart;,citation_author=E. Turak;,citation_author=M. Walpole;,citation_author=M. Wegmann;,citation_publication_date=2013-01-18;,citation_cover_date=2013-01-18;,citation_year=2013;,citation_fulltext_html_url=https://www.sciencemag.org/lookup/doi/10.1126/science.1229931;,citation_issue=6117;,citation_doi=10.1126/science.1229931;,citation_volume=339;,citation_language=en;,citation_journal_title=Science;">
<meta name="citation_reference" content="citation_title=Indicators for Monitoring Biodiversity: A Hierarchical Approach;,citation_author=Reed F. Noss;,citation_publication_date=1990;,citation_cover_date=1990;,citation_year=1990;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1523-1739.1990.tb00309.x;,citation_issue=4;,citation_doi=10.1111/j.1523-1739.1990.tb00309.x;,citation_volume=4;,citation_language=en;,citation_journal_title=Conservation Biology;">
<meta name="citation_reference" content="citation_title=Satellite remote sensing of ecosystem functions: opportunities, challenges and way forward;,citation_author=Nathalie Pettorelli;,citation_author=Henrike Schulte to Bühne;,citation_author=Ayesha Tulloch;,citation_author=Grégoire Dubois;,citation_author=Cate Macinnis-Ng;,citation_author=Ana M. Queirós;,citation_author=David A. Keith;,citation_author=Martin Wegmann;,citation_author=Franziska Schrodt;,citation_author=Marion Stellmes;,citation_author=Ruth Sonnenschein;,citation_author=Gary N. Geller;,citation_author=Shovonlal Roy;,citation_author=Ben Somers;,citation_author=Nicholas Murray;,citation_author=Lucie Bland;,citation_author=Ilse Geijzendorffer;,citation_author=Jeremy T. Kerr;,citation_author=Stefanie Broszeit;,citation_author=Pedro J. Leitão;,citation_author=Clare Duncan;,citation_author=Ghada El Serafy;,citation_author=Kate S. He;,citation_author=Julia L. Blanchard;,citation_author=Richard Lucas;,citation_author=Paola Mairota;,citation_author=Thomas J. Webb;,citation_author=Emily Nicholson;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1002/rse2.59;,citation_issue=2;,citation_doi=10.1002/rse2.59;,citation_volume=4;,citation_language=en;,citation_journal_title=Remote Sensing in Ecology and Conservation;">
<meta name="citation_reference" content="citation_title=Measuring the extent and effectiveness of protected areas as an indicator for meeting global biodiversity targets;,citation_author=S Chape;,citation_author=J Harrison;,citation_author=M Spalding;,citation_author=I Lysenko;,citation_publication_date=2005-02;,citation_cover_date=2005-02;,citation_year=2005;,citation_fulltext_html_url=https://royalsocietypublishing.org/doi/10.1098/rstb.2004.1592;,citation_issue=1454;,citation_doi=10.1098/rstb.2004.1592;,citation_volume=360;,citation_journal_title=Philosophical Transactions of the Royal Society B: Biological Sciences;">
<meta name="citation_reference" content="citation_title=Global State of Biodiversity and Loss;,citation_author=Rodolfo Dirzo;,citation_author=Peter H. Raven;,citation_publication_date=2003-11-01;,citation_cover_date=2003-11-01;,citation_year=2003;,citation_fulltext_html_url=https://www.annualreviews.org/content/journals/10.1146/annurev.energy.28.050302.105532;,citation_issue=Volume 28, 2003;,citation_doi=10.1146/annurev.energy.28.050302.105532;,citation_volume=28;,citation_language=en;,citation_journal_title=Annual Review of Environment and Resources;">
<meta name="citation_reference" content="citation_title=Using the satellite-derived NDVI to assess ecological responses to environmental change;,citation_author=Nathalie Pettorelli;,citation_author=Jon Olav Vik;,citation_author=Atle Mysterud;,citation_author=Jean-Michel Gaillard;,citation_author=Compton J. Tucker;,citation_author=Nils Chr. Stenseth;,citation_publication_date=2005-09-01;,citation_cover_date=2005-09-01;,citation_year=2005;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S016953470500162X;,citation_issue=9;,citation_doi=10.1016/j.tree.2005.05.011;,citation_volume=20;,citation_language=en;,citation_journal_title=Trends in Ecology &amp;amp;amp; Evolution;">
<meta name="citation_reference" content="citation_title=Counterfactual thinking and impact evaluation in environmental policy;,citation_author=Paul J. Ferraro;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1002/ev.297;,citation_issue=122;,citation_doi=10.1002/ev.297;,citation_volume=2009;,citation_language=en;,citation_journal_title=New Directions for Evaluation;">
<meta name="citation_reference" content="citation_title=Statistical matching for conservation science;,citation_author=Judith Schleicher;,citation_author=Johanna Eklund;,citation_author=Megan D. Barnes;,citation_author=Jonas Geldmann;,citation_author=Johan A. Oldekop;,citation_author=Julia P. G. Jones;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1111/cobi.13448;,citation_issue=3;,citation_doi=10.1111/cobi.13448;,citation_volume=34;,citation_language=en;,citation_journal_title=Conservation Biology;">
<meta name="citation_reference" content="citation_title=Estimating counterfactuals for evaluation of ecological and conservation impact: an introduction to matching methods;,citation_author=Luiz G. S. Ribas;,citation_author=Robert L. Pressey;,citation_author=Luis M. Bini;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://onlinelibrary.wiley.com/doi/abs/10.1111/brv.12697;,citation_issue=4;,citation_doi=10.1111/brv.12697;,citation_volume=96;,citation_language=en;,citation_journal_title=Biological Reviews;">
<meta name="citation_reference" content="citation_title=Causal Inference without Balance Checking: Coarsened Exact Matching;,citation_author=Stefano M. Iacus;,citation_author=Gary King;,citation_author=Giuseppe Porro;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_fulltext_html_url=https://www.cambridge.org/core/product/identifier/S1047198700012985/type/journal_article;,citation_issue=1;,citation_doi=10.1093/pan/mpr013;,citation_volume=20;,citation_language=en;,citation_journal_title=Political Analysis;">
<meta name="citation_reference" content="citation_title=An introduction to propensity score methods for reducing the effects of confounding in observational studies;,citation_author=Peter C. Austin;,citation_publication_date=2011-05;,citation_cover_date=2011-05;,citation_year=2011;,citation_fulltext_html_url=https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3144483/;,citation_issue=3;,citation_doi=10.1080/00273171.2011.568786;,citation_volume=46;,citation_journal_title=Multivariate Behavioral Research;">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Spatially explicit mapping of ecological similarity across a large region using matching techniques.</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Evan Muise <a href="mailto:evanmuis@student.ubc.ca" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-3404-3220" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Department of Forest Resource Management, University of British Columbia, Vancouver, 2424 Main Mall, British Columbia, Canada
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Nicholas Coops <a href="https://orcid.org/0000-0002-7859-8394" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Department of Forest Resource Management, University of British Columbia, Vancouver, 2424 Main Mall, British Columbia, Canada
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">April 25, 2024</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></p></div><div class="quarto-title-meta-contents"><p><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF (agu)</a></p></div><div class="quarto-title-meta-contents"><p><a href="index-meca.zip" data-meca-link="true"><i class="bi bi-archive"></i>MECA Bundle</a></p></div></div></div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>ABSTRACT</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>Protected areas, Matching methods, Coarsened exact matching, Essential Biodiversity Variables</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#sec-data-methods" id="toc-sec-data-methods" class="nav-link" data-scroll-target="#sec-data-methods"><span class="header-section-number">2</span> Data &amp; Methods</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">4</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>A global biodiversity crisis is currently underway, driven by anthropogenic changes and pressures such as climate change, land-use changes, and invasive species, among others <span class="citation" data-cites="dirzo2003">(<a href="#ref-dirzo2003" role="doc-biblioref">Dirzo and Raven 2003</a>)</span>. Protected areas have been demonstrated to be one of the most effective potential safeguards against these biodiversity losses <span class="citation" data-cites="chape2005">(<a href="#ref-chape2005" role="doc-biblioref">Chape et al. 2005</a>)</span>. To assess the effectiveness of protected areas, it is necessary to collect data across entire jurisdictions and compare them to similar ecosystems that are not protected. However, collecting direct, field-derived information on biodiversity across large regions is simply not feasible due to financial and temporal constraints.</p>
<p>Remote sensing data, however, can provide a time-efficient, cost-effective alternative to field data, and can be used to generate Essential Biodiversity Variables (EBVs) which are comparable, standardized datasets capable of measuring biodiversity change across large spatial extents through time <span class="citation" data-cites="skidmore2021 pereira2013">(<a href="#ref-skidmore2021" role="doc-biblioref">Skidmore et al. 2021</a>; <a href="#ref-pereira2013" role="doc-biblioref">Pereira et al. 2013</a>)</span>. Two EBV classes are particularly well suited to be used at regional to national scales; ecosystem structure and ecosystem function. Ecosystem structure is defined as the physical organization of biotic and abiotic materials in the system, and is commonly assessed as land cover and forest structural attributes using remote sensing <span class="citation" data-cites="noss1990">(<a href="#ref-noss1990" role="doc-biblioref">Noss 1990</a>)</span>. Ecosystem function are attributes related to ecosystem performance, such as the inflows or outflows of energy/nutrients <span class="citation" data-cites="pettorelli2018">(<a href="#ref-pettorelli2018" role="doc-biblioref">Pettorelli et al. 2018</a>)</span>. Remote sensing of ecosystem function commonly includes productivity metrics such as GPP <span class="citation" data-cites="pettorelli2005 pettorelli2018">(<a href="#ref-pettorelli2005" role="doc-biblioref">Pettorelli et al. 2005</a>, <a href="#ref-pettorelli2018" role="doc-biblioref">2018</a>)</span>. Remote sensing-derived EBVs provide suitable spatial coverage, temporal depth, and temporal frequency to be used for biodiversity monitoring <span class="citation" data-cites="skidmore2021">(<a href="#ref-skidmore2021" role="doc-biblioref">Skidmore et al. 2021</a>)</span>, and thus, protected area effectiveness assessments.</p>
<p>The use of impact assessment techniques such as matching is becoming increasingly prevalent in studies of the effectiveness of protected areas <span class="citation" data-cites="ferraro2009">(<a href="#ref-ferraro2009" role="doc-biblioref">Ferraro 2009</a>)</span>. Matching methods generally work by creating a counterfactual scenario in which conservation outcomes are compared between the protected area and what those outcomes would be if the given area were not protected <span class="citation" data-cites="ribas2021">(<a href="#ref-ribas2021" role="doc-biblioref">Ribas, Pressey, and Bini 2021</a>)</span>. This is achieved by comparing a given protected area to an unprotected area with similar covariates, such as climate, topography, and various anthropogenic data. Propensity score matching uses the covariates and protected status with a logit regression to create a propensity score, which is then used to match the protected area to an unprotected area <span class="citation" data-cites="austin2011">(<a href="#ref-austin2011" role="doc-biblioref">Austin 2011</a>)</span>. Coarsened exact matching (CEM) initially coarsens the covariates into bins (percentiles) and then performs exact matching on these bins, while retaining the original, uncoarsened data <span class="citation" data-cites="iacus2012">(<a href="#ref-iacus2012" role="doc-biblioref">Iacus, King, and Porro 2012</a>)</span>. Other matching methods exist <span class="citation" data-cites="schleicher2020">(see <a href="#ref-schleicher2020" role="doc-biblioref">Schleicher et al. 2020</a>)</span>, but one common issue common to these methods is that many data samples are dropped because there is no suitable match to be found. This can be problematic when attempting to create spatial counterfactuals, such as when evaluating the efficacy of protected areas across large regions, as it can lead to a loss of spatial coverage.</p>
<p>In this study, we seek to enhance the spatial coverage of CEM using a two-step approach. Firstly, we coarsen the covariates into bins, and then perform exact matching on these bins. In the event that no suitable match can be found, a KNN (k = 1) approach is used to identify the nearest match. This two-step approach allows for a more comprehensive assessment of the effectiveness of protected areas, where no observations are discarded. This method is applied to the forested regions of British Columbia, Canada, and the effectiveness of protected areas to is compared to similar ecosystems that are not protected. We compare the spatial coverage of standard CEM method and our expanded CEM method, and also apply both methods for assessing protected area effectiveness at conserving two EBV classes; ecosystem structure and ecosystem function. Further, we generate bootstrap confidence intervals for each CEM bin for our two EBV classes and compare every forested area in BC to their respective confidence interval. This allows for the respatialization of the results, allowing for managers to identify regions in need of restoration (outside the confidence interval, in protected areas), or protection (inside the confidence interval, outside of protected areas).</p>
</section>
<section id="sec-data-methods" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-data-methods"><span class="header-section-number">2</span> Data &amp; Methods</h2>
</section>
<section id="results" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="results"><span class="header-section-number">3</span> Results</h2>
</section>
<section id="conclusion" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">4</span> Conclusion</h2>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-austin2011" class="csl-entry" role="listitem">
Austin, Peter C. 2011. <span>“An Introduction to Propensity Score Methods for Reducing the Effects of Confounding in Observational Studies.”</span> <em>Multivariate Behavioral Research</em> 46 (3): 399–424. <a href="https://doi.org/10.1080/00273171.2011.568786">https://doi.org/10.1080/00273171.2011.568786</a>.
</div>
<div id="ref-chape2005" class="csl-entry" role="listitem">
Chape, S, J Harrison, M Spalding, and I Lysenko. 2005. <span>“Measuring the Extent and Effectiveness of Protected Areas as an Indicator for Meeting Global Biodiversity Targets.”</span> <em>Philosophical Transactions of the Royal Society B: Biological Sciences</em> 360 (1454): 443455. <a href="https://doi.org/10.1098/rstb.2004.1592">https://doi.org/10.1098/rstb.2004.1592</a>.
</div>
<div id="ref-dirzo2003" class="csl-entry" role="listitem">
Dirzo, Rodolfo, and Peter H. Raven. 2003. <span>“Global State of Biodiversity and Loss.”</span> <em>Annual Review of Environment and Resources</em> 28 (Volume 28, 2003): 137–67. <a href="https://doi.org/10.1146/annurev.energy.28.050302.105532">https://doi.org/10.1146/annurev.energy.28.050302.105532</a>.
</div>
<div id="ref-ferraro2009" class="csl-entry" role="listitem">
Ferraro, Paul J. 2009. <span>“Counterfactual Thinking and Impact Evaluation in Environmental Policy.”</span> <em>New Directions for Evaluation</em> 2009 (122): 75–84. <a href="https://doi.org/10.1002/ev.297">https://doi.org/10.1002/ev.297</a>.
</div>
<div id="ref-iacus2012" class="csl-entry" role="listitem">
Iacus, Stefano M., Gary King, and Giuseppe Porro. 2012. <span>“Causal Inference Without Balance Checking: Coarsened Exact Matching.”</span> <em>Political Analysis</em> 20 (1): 1–24. <a href="https://doi.org/10.1093/pan/mpr013">https://doi.org/10.1093/pan/mpr013</a>.
</div>
<div id="ref-noss1990" class="csl-entry" role="listitem">
Noss, Reed F. 1990. <span>“Indicators for Monitoring Biodiversity: A Hierarchical Approach.”</span> <em>Conservation Biology</em> 4 (4): 355–64. <a href="https://doi.org/10.1111/j.1523-1739.1990.tb00309.x">https://doi.org/10.1111/j.1523-1739.1990.tb00309.x</a>.
</div>
<div id="ref-pereira2013" class="csl-entry" role="listitem">
Pereira, H. M., S. Ferrier, M. Walters, G. N. Geller, R. H. G. Jongman, R. J. Scholes, M. W. Bruford, et al. 2013. <span>“Essential Biodiversity Variables.”</span> <em>Science</em> 339 (6117): 277–78. <a href="https://doi.org/10.1126/science.1229931">https://doi.org/10.1126/science.1229931</a>.
</div>
<div id="ref-pettorelli2018" class="csl-entry" role="listitem">
Pettorelli, Nathalie, Henrike Schulte to Bühne, Ayesha Tulloch, Grégoire Dubois, Cate Macinnis-Ng, Ana M. Queirós, David A. Keith, et al. 2018. <span>“Satellite Remote Sensing of Ecosystem Functions: Opportunities, Challenges and Way Forward.”</span> <em>Remote Sensing in Ecology and Conservation</em> 4 (2): 71–93. <a href="https://doi.org/10.1002/rse2.59">https://doi.org/10.1002/rse2.59</a>.
</div>
<div id="ref-pettorelli2005" class="csl-entry" role="listitem">
Pettorelli, Nathalie, Jon Olav Vik, Atle Mysterud, Jean-Michel Gaillard, Compton J. Tucker, and Nils Chr. Stenseth. 2005. <span>“Using the Satellite-Derived NDVI to Assess Ecological Responses to Environmental Change.”</span> <em>Trends in Ecology &amp; Evolution</em> 20 (9): 503–10. <a href="https://doi.org/10.1016/j.tree.2005.05.011">https://doi.org/10.1016/j.tree.2005.05.011</a>.
</div>
<div id="ref-ribas2021" class="csl-entry" role="listitem">
Ribas, Luiz G. S., Robert L. Pressey, and Luis M. Bini. 2021. <span>“Estimating Counterfactuals for Evaluation of Ecological and Conservation Impact: An Introduction to Matching Methods.”</span> <em>Biological Reviews</em> 96 (4): 1186–1204. <a href="https://doi.org/10.1111/brv.12697">https://doi.org/10.1111/brv.12697</a>.
</div>
<div id="ref-schleicher2020" class="csl-entry" role="listitem">
Schleicher, Judith, Johanna Eklund, Megan D. Barnes, Jonas Geldmann, Johan A. Oldekop, and Julia P. G. Jones. 2020. <span>“Statistical Matching for Conservation Science.”</span> <em>Conservation Biology</em> 34 (3): 538–49. <a href="https://doi.org/10.1111/cobi.13448">https://doi.org/10.1111/cobi.13448</a>.
</div>
<div id="ref-skidmore2021" class="csl-entry" role="listitem">
Skidmore, Andrew K., Nicholas C. Coops, Elnaz Neinavaz, Abebe Ali, Michael E. Schaepman, Marc Paganini, W. Daniel Kissling, et al. 2021. <span>“Priority List of Biodiversity Metrics to Observe from Space.”</span> <em>Nature Ecology &amp; Evolution</em>, May. <a href="https://doi.org/10.1038/s41559-021-01451-x">https://doi.org/10.1038/s41559-021-01451-x</a>.
</div>
</div>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{muise2024,
  author = {Muise, Evan and Coops, Nicholas},
  title = {Spatially Explicit Mapping of Ecological Similarity Across a
    Large Region Using Matching Techniques.},
  date = {2024-04-25},
  langid = {en},
  abstract = {ABSTRACT}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-muise2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Muise, Evan, and Nicholas Coops. 2024. <span>“Spatially Explicit Mapping
of Ecological Similarity Across a Large Region Using Matching
Techniques.”</span> Earth and Space Science. April 25, 2024.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>